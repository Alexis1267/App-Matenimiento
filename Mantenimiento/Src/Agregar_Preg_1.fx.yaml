Agregar_Preg_1 As screen:
    Fill: =RGBA(21, 44, 115, 1)
    OnVisible: |-
        =/*//IMG1
        Set(ImgName1,Concatenate("AyudaVisual_1-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
        
            // Get file1 binary data and convert it to base64
            Set(attachmentImgValue1, JSON(UploadedImage1.Image, JSONFormat.IncludeBinaryData));
        
            Set(attachmentImg1Base64Only, Mid(attachmentImgValue1, Find(",", attachmentImgValue1)+1, Len(attachmentImgValue1) - Find(",", attachmentImgValue1)-1 ));
        
            // Upload file1 and get url
        //Set(IMG1,Flow_Imagenes_Actividades.Run(ImgName1,attachmentImg1Base64Only).sharepointfilelink);
        
        
        ////////////////////////////////////////////////////////////
        //IMG2
        Set(ImgName2,Concatenate("AyudaVisual_2-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
        
            // Get file1 binary data and convert it to base64
            Set(attachmentImg2Value1, JSON(UploadedImage2.Image, JSONFormat.IncludeBinaryData));
        
            Set(attachmentImg2Base64Only, Mid(attachmentImg2Value1, Find(",", attachmentImg2Value1)+1, Len(attachmentImg2Value1) - Find(",", attachmentImg2Value1)-1 ));
        
            // Upload file1 and get url
        //Set(IMG2,Flow_Imagenes_Actividades.Run(ImgName2,attachmentImg2Base64Only).sharepointfilelink);
        
        ////////////////////////////////////////////////////////////
        //IMG3
        Set(ImgName3,Concatenate("AyudaVisual_3-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
        
            // Get file1 binary data and convert it to base64
            Set(attachmentImg3Value1, JSON(UploadedImage3.Image, JSONFormat.IncludeBinaryData));
        
            Set(attachmentImg3Base64Only, Mid(attachmentImg3Value1, Find(",", attachmentImg3Value1)+1, Len(attachmentImg3Value1) - Find(",", attachmentImg3Value1)-1 ));
        
            // Upload file1 and get url
        //Set(IMG3,Flow_Imagenes_Actividades.Run(ImgName3,attachmentImg3Base64Only).sharepointfilelink);
        
        ///////////////////////////////////////////////////////////
        //IMG4
        Set(ImgName4,Concatenate("AyudaVisual_4-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
        
            // Get file1 binary data and convert it to base64
            Set(attachmentImg4Value1, JSON(UploadedImage4.Image, JSONFormat.IncludeBinaryData));
        
            Set(attachmentImg4Base64Only, Mid(attachmentImg4Value1, Find(",", attachmentImg4Value1)+1, Len(attachmentImg4Value1) - Find(",", attachmentImg4Value1)-1 ));
        
            // Upload file1 and get url
        //Set(IMG4,Flow_Imagenes_Actividades.Run(ImgName4,attachmentImg4Base64Only).sharepointfilelink);
        
        ///////////////////////////////////////////////////////////
        //IMG5
        Set(ImgName5,Concatenate("AyudaVisual_5-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
        
            // Get file1 binary data and convert it to base64
            Set(attachmentImg5Value1, JSON(UploadedImage5.Image, JSONFormat.IncludeBinaryData));
        
            Set(attachmentImg5Base64Only, Mid(attachmentImg5Value1, Find(",", attachmentImg5Value1)+1, Len(attachmentImg5Value1) - Find(",", attachmentImg5Value1)-1 ));
        
            // Upload file1 and get url
        //Set(IMG5,Flow_Imagenes_Actividades.Run(ImgName5,attachmentImg5Base64Only).sharepointfilelink);*/

    Titulo_17 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(237, 237, 237, 1)
        Height: =80
        RadiusBottomLeft: =30
        RadiusBottomRight: =30
        RadiusTopLeft: =30
        RadiusTopRight: =30
        Width: =1330
        X: =20
        Y: =18
        ZIndex: =1

        Label3_9 As label:
            Align: =Align.Center
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =80
            Size: =30
            Text: ="AGREGAR NUEVA ACTIVIDAD"
            Width: =1329
            ZIndex: =1

        Image2_5 As image:
            Height: =80
            Image: =carrier_logo_300
            Width: =158
            X: =1161
            ZIndex: =2

    Container1_47 As groupContainer.manualLayoutContainer:
        Height: =768
        PaddingRight: =0.00
        PaddingTop: =0.00
        Visible: =ShowPopUp
        Width: =1366
        X: =0.00
        Y: |
            =0
        ZIndex: =5

        HtmlText3_61 As htmlViewer:
            Height: =768
            HtmlText: |-
                ="<div style=""
                position: absolute;
                  text-align: center;
                  color: #fff;
                  box-shadow: 0px 0px 25px #222;
                  backdrop-filter: blur(10px);
                height:"& 1080 &"px;
                width:"& 1920 &"px;""></div>"
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0.00
            PaddingTop: =0.00
            Size: =14.04
            Visible: =ShowPopUp
            Width: =1366
            ZIndex: =1

        Container2_47 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(227, 234, 243, 1)
            Height: =595
            PaddingRight: =0.00
            PaddingTop: =0.00
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =1272.89
            X: =56
            Y: =112
            ZIndex: =2

            Rectangle3_49 As rectangle:
                Fill: =RGBA(21, 44, 115, 1)
                Height: =65
                Width: =1272.89
                X: =0.00
                ZIndex: =4

            Button7_59 As button:
                BorderStyle: =BorderStyle.None
                DisplayMode: |
                    =//Validacion de boton de que debe cumplir y escribir en justificacion
                    If(IsBlank(TextInput1_247.Text) || IsBlank(Dropdown4_48.Selected.Value) ,DisplayMode.Disabled,DisplayMode.Edit) //Lo que dice este codigo es de que si el input text de la justificacion esta en blanco, que el boton sea disable y si tiene algo escrito, que se active el boton para seguir con la accion
                    
                    
                    //BOTONES
                Fill: =RGBA(97, 181, 73, 1)
                FontWeight: =FontWeight.Bold
                OnSelect: |+
                    =
                    // Set file1 name
                        Set(fileName1, Concatenate(TextInput1_244.Text &"_1",Now(),".jpg"));
                    
                     
                    
                        // Get file1 binary data and convert it to base64
                        Set(attachmentValue1, JSON(UploadedImage7_47.Image, JSONFormat.IncludeBinaryData));
                        Set(attachment1Base64Only, Mid(attachmentValue1, Find(",", attachmentValue1)+1, Len(attachmentValue1) - Find(",", attachmentValue1)-1 ));
                    
                     
                    
                        // Upload file1 and get url
                        //Set(attachment1Link,Flujo_ImagenesMP.Run(fileName1,attachment1Base64Only).sharepointfilelink);
                    
                    Set(attachment1Link,Flujo_ImagenesMP.Run(fileName1,attachment1Base64Only).sharepointfilelink);
                    
                    
                    
                    
                    
                    
                    
                    //INGRESAR DATOS A LA TABLA HALLAZGOS
                    
                    Patch(CMXE_TablaH_MP,Defaults(CMXE_TablaH_MP),
                    {
                    Asignado: Dropdown4_48.Selected.Value,
                    Localizacion: TextInput1_243.Text,
                    Proc_No: TextInput1_244.Text,
                    Nom_Maquina:TextInput1_245.Text,
                    Clas_Mantenimiento: TextInput1_246.Text,
                    Fecha_Inicio: Now(),
                    Justificacion: TextInput1_247.Text,
                    Imagenes: attachment1Link,
                    Actividad: ACT_46.Text,
                    Estatus: "Abierto"
                    });
                    
                    Notify("El reporte se ha enviado con Ã©xito.", NotificationType.Success);
                    
                    
                    //Deshabilitar botonHallazgo
                    UpdateContext({BotonHallazgo: true});
                    
                    UpdateContext({ShowPopUp: false}); //En este boton lo que debera de ser es enviar los datos que traje y cerrar el ModalPopUp
                    Reset(TextInput1_247);
                    Reset(AddMediaButton6_47);
                    
                    //BOTONES
                    
                    
                    
                    
                    
                    
                PaddingRight: =6.37
                PaddingTop: =6.37
                Size: =19.14
                Text: ="Enviar"
                Width: =204.07
                X: =534.40
                Y: =538
                ZIndex: =5

            Icon4_48 As icon.Cancel:
                Color: =RGBA(255, 255, 255, 1)
                Height: =65
                Icon: =Icon.Cancel
                OnSelect: |+
                    =UpdateContext({ShowPopUp: false});
                    Reset(TextInput1_247);
                    Reset(AddMediaButton6_47);
                    Reset(Dropdown4_48);
                    
                    
                    
                    
                    
                    
                    
                PaddingRight: =0.00
                PaddingTop: =0.00
                Width: =81.63
                X: =1191.25
                ZIndex: =6

            Image4_48 As image:
                Height: =65
                Image: =carrier_logo_300
                PaddingRight: =0.00
                PaddingTop: =0.00
                Width: =150.49
                X: =25.51
                ZIndex: =7

            Label9_481 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Bold
                Height: =65
                PaddingRight: =6.37
                PaddingTop: =6.37
                Size: =35
                Text: ="Reporte de hallazgo"
                Width: =531.85
                X: =369.88
                ZIndex: =8

            Group13_51 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =19

                Label9_482 As label:
                    FontWeight: =FontWeight.Bold
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Text: |-
                        ="LocalizaciÃ³n:"
                    Width: =233.41
                    X: =25.51
                    Y: =65
                    ZIndex: =10

                TextInput1_243 As text:
                    Default: =Dato_Localizacion
                    DisplayMode: =DisplayMode.View
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Width: =311.19
                    X: =25.51
                    Y: =105
                    ZIndex: =11

            Group12_48 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =19

                Label9_483 As label:
                    FontWeight: =FontWeight.Bold
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Text: |-
                        ="Nombre del activo:"
                    Width: =278.06
                    X: =404.31
                    Y: =65
                    ZIndex: =12

                TextInput1_244 As text:
                    Default: =Dato_Proc_No
                    DisplayMode: =DisplayMode.View
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Width: =369.88
                    X: =404.31
                    Y: =105
                    ZIndex: =13

            Group10_47 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =19

                Label9_485 As label:
                    FontWeight: =FontWeight.Bold
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Text: |-
                        ="Nombre de la maquina:"
                    Width: =295.91
                    X: =25.51
                    Y: =155
                    ZIndex: =14

                TextInput1_245 As text:
                    Default: =Dato_NomMaquina
                    DisplayMode: =DisplayMode.View
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Width: =470.62
                    X: =25.51
                    Y: =195
                    ZIndex: =15

            Group11_47 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =19

                Label9_486 As label:
                    FontWeight: =FontWeight.Bold
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Text: |-
                        ="Clase de mantenimiento:"
                    Width: =318.86
                    X: =580.33
                    Y: =155
                    ZIndex: =16

                TextInput1_246 As text:
                    Default: =Dato_ClassMtto
                    DisplayMode: =DisplayMode.View
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Width: =438.75
                    X: =580.33
                    Y: =195
                    ZIndex: =17

            Group14_47 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =19

                ACT_46 As text:
                    Default: =ActividadMP
                    DisplayMode: =DisplayMode.View
                    Height: =68
                    Mode: =TextMode.MultiLine
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Width: =1200.18
                    X: =25.51
                    Y: =283
                    ZIndex: =9

                Label9_487 As label:
                    FontWeight: =FontWeight.Bold
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Text: |-
                        ="Actividad:"
                    Width: =191.32
                    X: =25.51
                    Y: =243
                    ZIndex: =18

            Group15_47 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =19

                Label9_488 As label:
                    FontWeight: =FontWeight.Bold
                    Height: =48
                    PaddingRight: =6.37
                    PaddingTop: =6.37
                    Size: =16.58
                    Text: |-
                        ="*JustificaciÃ³n:"
                    Width: =443.84
                    X: =20
                    Y: =351
                    ZIndex: =2

                TextInput1_247 As text:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    BorderThickness: =1
                    Clear: =true
                    Default: =
                    Height: =120
                    HintText: ="Agregue una justificaciÃ³n"
                    Mode: =TextMode.MultiLine
                    PaddingRight: =6.59
                    PaddingTop: =6.59
                    Reset: =true
                    Size: =17.13
                    Width: =632.62
                    X: =21
                    Y: =399
                    ZIndex: =3

            AddMediaWithImage6_47 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =19

                UploadedImage7_47 As image:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Height: =139
                    Image: =If(IsBlank(AddMediaButton6_47.Media), SampleImage, AddMediaButton6_47.Media)
                    PaddingRight: =0.00
                    PaddingTop: =0.00
                    Width: =239.78
                    X: =988.47
                    Y: =380
                    ZIndex: =19

                AddMediaButton6_47 As addMedia:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    ChangePictureText: ="Cambiar fotografia"
                    Height: =64
                    Size: =19.77
                    Text: ="Adjuntar evidencia"
                    Width: =247.77
                    X: =711
                    Y: =417
                    ZIndex: =20

            Label9_484 As label:
                FontWeight: =FontWeight.Bold
                PaddingRight: =6.37
                PaddingTop: =6.37
                Size: =16.58
                Text: |-
                    ="Persona que reporta hallazgo:"
                Width: =369.88
                X: =858.36
                Y: =65
                ZIndex: =21

            Dropdown4_48 As dropdown:
                BorderColor: =RGBA(0, 40, 85, 1)
                BorderThickness: =1
                ChevronBackground: =RGBA(21, 44, 115, 1)
                Default: =
                Items: |+
                    = 
                     //Split(Concat(Gallery2.AllItems, "" & Title2 & Char(10)), Char(10) & Char(10) & Label12_15.Text)
                     //Split(Label12_15.Text, Char(10))
                    
                    Filter(Split(Label12_15.Text, Char(10)), !IsBlank(Value))
                    
                    
                     
                    
                    //Concatenate(DropdownAsig,DropdownInvolu)
                    
                    //Split(Concat(Gallery2.AllItems , "" & Title2 & Char(10)),Concat(AsignadoOp,"" & NombreOp & Char(10), Char(10)))
                    
                     //Split(Concat(Gallery2.AllItems, "" & Title2 & Char(10)&Operador), Char(10))
                    
                    //Concatenate(Split(Concat(Gallery2.AllItems, "" & Title2 & Char(10)), Char(10)))
                    
                    /*Split(
                        Concatenate(
                            Text(Title2, "[$-en-US]0") &Char(10) & Text(Operador, "[$-en-US]0") & Char(10)
                        ),
                        Char(10)
                    )*/
                    
                    
                    
                    
                    
                    
                PaddingRight: =12.76
                PaddingTop: =12.76
                Size: =16.58
                Width: =367.32
                X: =858.36
                Y: =105
                ZIndex: =22

    Titulo_18 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =631
        RadiusBottomLeft: =30
        RadiusBottomRight: =30
        RadiusTopLeft: =30
        RadiusTopRight: =30
        Width: =1330
        X: =20
        Y: =117
        ZIndex: =6

        TextInput2_1 As text:
            Default: =""
            Visible: =BotonZona
            Width: =273
            X: =430
            Y: =117
            ZIndex: =3

        Label20_7 As label:
            FontWeight: =FontWeight.Bold
            Text: ="Zona"
            Width: =273
            X: =430
            Y: =6
            ZIndex: =22

        Dropdown4_1 As dropdown:
            Default: ="N/A"
            DisplayMode: =If(BotonZona,DisplayMode.Disabled,DisplayMode.Edit)
            Items: |+
                =//Sort(Distinct(Filter(PreventivSure_PreguntasMP,Localizacion = BtnLocalizacion,Activo_No = Dropdown2.SelectedText.Value,Clase_MTTO = Dropdown3.SelectedText.Value),Sub_Tarea),Value)
                
                If(
                    CountRows(
                        Filter(
                            Sort(
                                Distinct(
                                    Filter(
                                        PreventivSure_PreguntasMP,
                                        Localizacion = BtnLocalizacion,
                                        Activo_No = Dropdown2_2.SelectedText.Value,
                                        Clase_MTTO = Dropdown3_1.SelectedText.Value
                                    ),
                                    Sub_Tarea
                                ),
                                Value
                            ),
                            Value = "N/A"
                        )
                    ) = 0,
                    Concatenate(
                        Sort(
                            Distinct(
                                Filter(
                                    PreventivSure_PreguntasMP,
                                    Localizacion = BtnLocalizacion,
                                    Activo_No = Dropdown2_2.SelectedText.Value,
                                    Clase_MTTO = Dropdown3_1.SelectedText.Value
                                ),
                                Sub_Tarea
                            ),
                            Value
                        ),
                        ["N/A"]
                    ),
                    Sort(
                        Distinct(
                            Filter(
                                PreventivSure_PreguntasMP,
                                Localizacion = BtnLocalizacion,
                                Activo_No = Dropdown2_2.SelectedText.Value,
                                Clase_MTTO = Dropdown3_1.SelectedText.Value
                            ),
                            Sub_Tarea
                        ),
                        Value
                    )
                )
                
                
            Width: =273
            X: =430
            Y: =46
            ZIndex: =24

        Group10_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =24

            Dropdown2_2 As dropdown:
                Items: |+
                    =Sort(Distinct(Filter(CMXE_MP_N,Localizacion = BtnLocalizacion),ID_Maq),Value)
                    
                    
                    
                Width: =170
                X: =5
                Y: =46
                ZIndex: =1

            Label20_5 As label:
                FontWeight: =FontWeight.Bold
                Text: ="Activo.No"
                Width: =170
                X: =5
                Y: =6
                ZIndex: =20

        Group11_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =24

            Dropdown3_1 As dropdown:
                Items: |
                    =Sort(Distinct(Filter(CMXE_MP_N,Localizacion = BtnLocalizacion, ID_Maq = Dropdown2_2.SelectedText.Value),Clas_Mantenimineto),Value)
                Width: =213
                X: =195
                Y: =46
                ZIndex: =2

            Label20_6 As label:
                FontWeight: =FontWeight.Bold
                Text: ="Clase de MTTO"
                Width: =213
                X: =195
                Y: =6
                ZIndex: =21

        Group13_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =24

            TextInput3_1 As text:
                Default: =""
                DisplayMode: |
                    =
                Height: =125
                Mode: =TextMode.MultiLine
                Width: =585
                X: =733
                Y: =46
                ZIndex: =4

            Label20_8 As label:
                FontWeight: =FontWeight.Bold
                Text: ="Nueva Actividad"
                Width: =585
                X: =733
                Y: =6
                ZIndex: =23

        Icon1_3 As icon.Add:
            Height: =27
            Icon: =Icon.Add
            OnSelect: |-
                =UpdateContext({BotonZona:!BotonZona})
            Width: =28
            X: =430
            Y: =90
            ZIndex: =26

        Label21_1 As label:
            Height: =27
            Text: ="Agregar nueva Zona"
            Width: =218
            X: =458
            Y: =90
            ZIndex: =27

        Button13_1 As button:
            Fill: =RGBA(141, 198, 63, 1)
            Height: =35
            OnSelect: |+
                =//IMG1
                Set(ImgName1,Concatenate("AyudaVisual_1-"&BtnLocalizacion&"-"&Dropdown2_2.SelectedText.Value&"-"&Dropdown3_1.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImgValue1, JSON(UploadedImage1_1.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg1Base64Only, Mid(attachmentImgValue1, Find(",", attachmentImgValue1)+1, Len(attachmentImgValue1) - Find(",", attachmentImgValue1)-1 ));
                
                //IMG2
                Set(ImgName2,Concatenate("AyudaVisual_2-"&BtnLocalizacion&"-"&Dropdown2_2.SelectedText.Value&"-"&Dropdown3_1.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImg2Value1, JSON(UploadedImage2_1.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg2Base64Only, Mid(attachmentImg2Value1, Find(",", attachmentImg2Value1)+1, Len(attachmentImg2Value1) - Find(",", attachmentImg2Value1)-1 ));
                
                
                //IMG3
                Set(ImgName3,Concatenate("AyudaVisual_3-"&BtnLocalizacion&"-"&Dropdown2_2.SelectedText.Value&"-"&Dropdown3_1.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImg3Value1, JSON(UploadedImage3_1.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg3Base64Only, Mid(attachmentImg3Value1, Find(",", attachmentImg3Value1)+1, Len(attachmentImg3Value1) - Find(",", attachmentImg3Value1)-1 ));
                
                //IMG4
                Set(ImgName4,Concatenate("AyudaVisual_4-"&BtnLocalizacion&"-"&Dropdown2_2.SelectedText.Value&"-"&Dropdown3_1.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImg4Value1, JSON(UploadedImage4_1.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg4Base64Only, Mid(attachmentImg4Value1, Find(",", attachmentImg4Value1)+1, Len(attachmentImg4Value1) - Find(",", attachmentImg4Value1)-1 ));
                
                //IMG5
                Set(ImgName5,Concatenate("AyudaVisual_5-"&BtnLocalizacion&"-"&Dropdown2_2.SelectedText.Value&"-"&Dropdown3_1.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImg5Value1, JSON(UploadedImage5_1.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg5Base64Only, Mid(attachmentImg5Value1, Find(",", attachmentImg5Value1)+1, Len(attachmentImg5Value1) - Find(",", attachmentImg5Value1)-1 ));
                
                
                
                
                
                
                
                
                //AGREGAR NUEVA ACTIVIDAD A PRENSAS
                If(IsBlank(TextInput3_1.Text),Notify("No puedes dejar campos vacios",NotificationType.Error),
                SpIn_PreventivSure_InsertarActividadDatos.Run(
                Dropdown2_2.SelectedText.Value,
                Dropdown3_1.SelectedText.Value,
                If(Dropdown4_1.DisplayMode = DisplayMode.Disabled,TextInput2_1.Text,Dropdown4_1.SelectedText.Value),
                TextInput3_1.Text,
                If(IsBlank(AddMediaButton1_1.Media),"N/T",UploadedImage1_1.Image),
                If(IsBlank(AddMediaButton2_1.Media),"N/T",Flow_Imagenes_Actividades.Run(ImgName2,attachmentImg2Base64Only).sharepointfilelink),
                If(IsBlank(AddMediaButton3_1.Media),"N/T",Flow_Imagenes_Actividades.Run(ImgName3,attachmentImg3Base64Only).sharepointfilelink),
                If(IsBlank(AddMediaButton4_1.Media),"N/T",Flow_Imagenes_Actividades.Run(ImgName4,attachmentImg4Base64Only).sharepointfilelink),
                If(IsBlank(AddMediaButton5_1.Media),"N/T",Flow_Imagenes_Actividades.Run(ImgName5,attachmentImg5Base64Only).sharepointfilelink)),Notify("Se ha registraro la nueva actividad correctamente.",NotificationType.Success));
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                /*//IMG1
                Set(ImgName1,Concatenate("AyudaVisual_1-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImgValue1, JSON(UploadedImage1.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg1Base64Only, Mid(attachmentImgValue1, Find(",", attachmentImgValue1)+1, Len(attachmentImgValue1) - Find(",", attachmentImgValue1)-1 ));
                
                    // Upload file1 and get url
                Set(IMG1,Flow_Imagenes_Actividades.Run(ImgName1,attachmentImg1Base64Only).sharepointfilelink);
                
                
                ////////////////////////////////////////////////////////////
                //IMG2
                Set(ImgName2,Concatenate("AyudaVisual_2-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImg2Value1, JSON(UploadedImage2.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg2Base64Only, Mid(attachmentImg2Value1, Find(",", attachmentImg2Value1)+1, Len(attachmentImg2Value1) - Find(",", attachmentImg2Value1)-1 ));
                
                    // Upload file1 and get url
                Set(IMG2,Flow_Imagenes_Actividades.Run(ImgName2,attachmentImg2Base64Only).sharepointfilelink);
                
                ////////////////////////////////////////////////////////////
                //IMG3
                Set(ImgName3,Concatenate("AyudaVisual_3-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImg3Value1, JSON(UploadedImage3.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg3Base64Only, Mid(attachmentImg3Value1, Find(",", attachmentImg3Value1)+1, Len(attachmentImg3Value1) - Find(",", attachmentImg3Value1)-1 ));
                
                    // Upload file1 and get url
                Set(IMG3,Flow_Imagenes_Actividades.Run(ImgName3,attachmentImg3Base64Only).sharepointfilelink);
                
                ///////////////////////////////////////////////////////////
                //IMG4
                Set(ImgName4,Concatenate("AyudaVisual_4-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImg4Value1, JSON(UploadedImage4.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg4Base64Only, Mid(attachmentImg4Value1, Find(",", attachmentImg4Value1)+1, Len(attachmentImg4Value1) - Find(",", attachmentImg4Value1)-1 ));
                
                    // Upload file1 and get url
                Set(IMG4,Flow_Imagenes_Actividades.Run(ImgName4,attachmentImg4Base64Only).sharepointfilelink);
                
                ///////////////////////////////////////////////////////////
                //IMG5
                Set(ImgName5,Concatenate("AyudaVisual_5-"&BtnLocalizacion&"-"&Dropdown2.SelectedText.Value&"-"&Dropdown3.SelectedText.Value&"_1",Now(),".jpg"));
                
                    // Get file1 binary data and convert it to base64
                    Set(attachmentImg5Value1, JSON(UploadedImage5.Image, JSONFormat.IncludeBinaryData));
                
                    Set(attachmentImg5Base64Only, Mid(attachmentImg5Value1, Find(",", attachmentImg5Value1)+1, Len(attachmentImg5Value1) - Find(",", attachmentImg5Value1)-1 ));
                
                    // Upload file1 and get url
                Set(IMG5,Flow_Imagenes_Actividades.Run(ImgName5,attachmentImg5Base64Only).sharepointfilelink);
                */
                
                
                
            Text: ="Registrar nueva pregunta"
            Width: =270
            X: =523
            Y: =567
            ZIndex: =28

        Dropdown2_3 As dropdown:
            DisplayMode: =DisplayMode.Disabled
            Items: |+
                =Sort(Distinct(Filter(CMXE_MP_N,ID_Maq = Dropdown2_2.SelectedText.Value),Nom_Equipo),Value)
                
                
                
            Width: =223
            X: =5
            Y: =140
            ZIndex: =29

        Button7_1 As button:
            Height: =64
            OnSelect: |-
                =UpdateContext({BtnVisualizarAct:true})
            Text: ="Visualizar actividades existentes"
            Width: =253
            X: =18
            Y: =552
            ZIndex: =35

        Label20_9 As label:
            FontWeight: =FontWeight.Bold
            Text: ="Nombre del equipo"
            Width: =223
            X: =5
            Y: =100
            ZIndex: =36

        "Gallery3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            Height: =496
            Items: =Pruebaimg1
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =104
            X: =297
            Y: =56
            ZIndex: =37

            Image11 As image:
                Height: =72
                Image: =ThisItem.photo
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Width: =72
                X: =16
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =1

            Title1 As label:
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.id
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.TemplateWidth - 173
                X: =103
                Y: =(Parent.TemplateHeight - (Self.Size * 1.8 + Subtitle1.Size * 1.8)) / 2
                ZIndex: =2

            Subtitle1 As label:
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.photo
                VerticalAlign: =VerticalAlign.Top
                Width: =Title1.Width
                X: =Title1.X
                Y: =Title1.Y + Title1.Height
                ZIndex: =3

            NextArrow1 As icon.ChevronRight:
                AccessibleLabel: =Self.Tooltip
                Color: =RGBA(166, 166, 166, 1)
                Height: =50
                Icon: =Icon.ChevronRight
                OnSelect: =Select(Parent)
                PaddingBottom: =16
                PaddingLeft: =16
                PaddingRight: =16
                PaddingTop: =16
                Tooltip: ="View item details"
                Width: =50
                X: =Parent.TemplateWidth - Self.Width - 12
                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                ZIndex: =4

            Separator1 As rectangle:
                Height: =8
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =5

            Rectangle1 As rectangle:
                Height: =Parent.TemplateHeight - Separator1.Height
                OnSelect: =Select(Parent)
                Visible: =ThisItem.IsSelected
                Width: =4
                ZIndex: =6

        Group12_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =37

            UploadedImage1_1 As image:
                Height: =180
                Image: =If(IsBlank(AddMediaButton1_1.Media), SampleImage, AddMediaButton1_1.Media)
                ImagePosition: =ImagePosition.Fill
                Width: =200
                X: =45
                Y: =267
                ZIndex: =6

            AddMediaButton1_1 As addMedia:
                ChangePictureText: ="Cambiar Imagen"
                Fill: =RGBA(202, 202, 202, 1)
                Height: =43
                Size: =13
                Text: ="Agregar imagen 1"
                Width: =200
                X: =45
                Y: =447
                ZIndex: =7

            Icon10_6 As icon.CancelBadge:
                Color: =RGBA(255, 0, 0, 1)
                Height: =35
                Icon: =Icon.CancelBadge
                OnSelect: |
                    =Reset(AddMediaButton1_1)
                Width: =34
                X: =211
                Y: =267
                ZIndex: =32

        Group14_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =37

            UploadedImage2_1 As image:
                Height: =180
                Image: =If(IsBlank(AddMediaButton2_1.Media), SampleImage, AddMediaButton2_1.Media)
                ImagePosition: =ImagePosition.Fill
                Width: =200
                X: =300
                Y: =267
                ZIndex: =9

            AddMediaButton2_1 As addMedia:
                ChangePictureText: ="Cambiar Imagen"
                Fill: =RGBA(202, 202, 202, 1)
                Height: =43
                Size: =13
                Text: ="Agregar imagen 2"
                Width: =200
                X: =300
                Y: =447
                ZIndex: =10

            Icon10_7 As icon.CancelBadge:
                Color: =RGBA(255, 0, 0, 1)
                Height: =35
                Icon: =Icon.CancelBadge
                OnSelect: |
                    =Reset(AddMediaButton2_1)
                Width: =34
                X: =463
                Y: =267
                ZIndex: =31

        Group15_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =37

            UploadedImage3_1 As image:
                Height: =180
                Image: =If(IsBlank(AddMediaButton3_1.Media), SampleImage, AddMediaButton3_1.Media)
                ImagePosition: =ImagePosition.Fill
                Width: =200
                X: =558
                Y: =267
                ZIndex: =12

            AddMediaButton3_1 As addMedia:
                ChangePictureText: ="Cambiar Imagen"
                Fill: =RGBA(202, 202, 202, 1)
                Height: =43
                Size: =13
                Text: ="Agregar imagen 3"
                Width: =200
                X: =558
                Y: =447
                ZIndex: =13

            Icon10_8 As icon.CancelBadge:
                Color: =RGBA(255, 0, 0, 1)
                Height: =35
                Icon: =Icon.CancelBadge
                OnSelect: |
                    =Reset(AddMediaButton3_1)
                Width: =34
                X: =724
                Y: =267
                ZIndex: =30

        Group18_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =37

            UploadedImage4_1 As image:
                Height: =180
                Image: =If(IsBlank(AddMediaButton4_1.Media), SampleImage, AddMediaButton4_1.Media)
                ImagePosition: =ImagePosition.Fill
                Width: =200
                X: =816
                Y: =267
                ZIndex: =15

            AddMediaButton4_1 As addMedia:
                ChangePictureText: ="Cambiar Imagen"
                Fill: =RGBA(202, 202, 202, 1)
                Height: =43
                Size: =13
                Text: ="Agregar imagen 4"
                Width: =200
                X: =816
                Y: =447
                ZIndex: =16

            Icon10_9 As icon.CancelBadge:
                Color: =RGBA(255, 0, 0, 1)
                Height: =35
                Icon: =Icon.CancelBadge
                OnSelect: |
                    =Reset(AddMediaButton4_1)
                Width: =34
                X: =982
                Y: =267
                ZIndex: =33

        Group19_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =37

            UploadedImage5_1 As image:
                Height: =180
                Image: =If(IsBlank(AddMediaButton5_1.Media), SampleImage, AddMediaButton5_1.Media)
                ImagePosition: =ImagePosition.Fill
                Width: =200
                X: =1087
                Y: =267
                ZIndex: =18

            AddMediaButton5_1 As addMedia:
                ChangePictureText: ="Cambiar Imagen"
                Fill: =RGBA(202, 202, 202, 1)
                Height: =43
                Size: =13
                Text: ="Agregar imagen 5"
                Width: =200
                X: =1087
                Y: =447
                ZIndex: =19

            Icon10_10 As icon.CancelBadge:
                Color: =RGBA(255, 0, 0, 1)
                Height: =35
                Icon: =Icon.CancelBadge
                OnSelect: |
                    =Reset(AddMediaButton5_1)
                Width: =34
                X: =1253
                Y: =267
                ZIndex: =34

    Icon1_7 As icon.BackArrow:
        DisplayMode: =
        Height: =75
        Icon: =Icon.BackArrow
        OnSelect: |
            =Navigate(Elegir,ScreenTransition.Fade)
        Width: =82
        X: =20
        Y: =20
        ZIndex: =8

    Container2_1 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(21, 44, 115, 1)
        Height: =768
        Visible: =BtnVisualizarAct
        Width: =1366
        ZIndex: =9

        Titulo_14 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(237, 237, 237, 1)
            Height: =80
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =1330
            X: =21
            Y: =18
            ZIndex: =1

            Label3_7 As label:
                Align: =Align.Center
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Bold
                Height: =80
                Size: =30
                Text: ="ACTIVIDADES CARGADAS"
                Width: =1157
                ZIndex: =1

            Icon12_3 As icon.Cancel:
                Color: =RGBA(255, 0, 0, 1)
                Height: =80
                Icon: =Icon.Cancel
                OnSelect: |-
                    =UpdateContext({BtnVisualizarAct:false})
                Width: =82
                X: =1247
                ZIndex: =2

            Titulo_15 As groupContainer.manualLayoutContainer:
                Fill: =RGBA(237, 237, 237, 1)
                Height: =80
                RadiusBottomLeft: =30
                RadiusBottomRight: =30
                RadiusTopLeft: =30
                RadiusTopRight: =30
                Width: =1330
                ZIndex: =3

                Label3_8 As label:
                    Align: =Align.Center
                    DisplayMode: =DisplayMode.View
                    Fill: =RGBA(255, 255, 255, 1)
                    FontWeight: =FontWeight.Bold
                    Height: =80
                    Size: =30
                    Text: ="ACTIVIDADES CARGADAS"
                    Width: =1330
                    ZIndex: =1

                Icon12_2 As icon.Cancel:
                    Color: =RGBA(255, 0, 0, 1)
                    Height: =80
                    Icon: =Icon.Cancel
                    OnSelect: |-
                        =UpdateContext({BtnVisualizarAct:false})
                    Width: =82
                    X: =1247
                    ZIndex: =2

        "Gallery8_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            BorderColor: =RGBA(0, 13, 75, 1)
            DelayItemLoading: =true
            Fill: =RGBA(255, 255, 255, 1)
            Height: =573
            Items: |-
                =Sort(
                    Sort(
                        Filter(
                            Search(PreventivSure_PreguntasMP, Dropdown2_2.SelectedText.Value, "Activo_No"),
                            Clase_MTTO = Dropdown3_1.SelectedText.Value
                        ),
                        Sub_Tarea
                    ),
                    Num_Pregunta
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =267
            Width: =1330
            X: =19
            Y: =195
            ZIndex: =2

            Image6_5 As image:
                Height: =150
                Image: =ThisItem.img1
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Width: =196
                X: =102
                Y: =117
                ZIndex: =1

            Title6_3 As label:
                AutoHeight: =true
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Actividad
                VerticalAlign: =VerticalAlign.Top
                Width: =768
                X: =51
                Y: =59
                ZIndex: =2

            Separator5_1 As rectangle:
                Fill: =RGBA(202, 202, 202, 1)
                Height: =8
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =5

            Rectangle9_1 As rectangle:
                Height: =Parent.TemplateHeight - Separator5_1.Height
                OnSelect: =Select(Parent)
                Visible: =ThisItem.IsSelected
                Width: =4
                ZIndex: =6

            Label22_1 As label:
                OnSelect: =Select(Parent)
                Text: =ThisItem.Num_Pregunta
                X: =4
                Y: =51
                ZIndex: =7

            Title6_2 As label:
                AutoHeight: =true
                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Sub_Tarea
                VerticalAlign: =VerticalAlign.Top
                Width: =768
                X: =40
                Y: =27
                ZIndex: =8

            Image6_6 As image:
                Height: =150
                Image: =ThisItem.img2
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Width: =196
                X: =332
                Y: =117
                ZIndex: =9

            Image6_7 As image:
                Height: =150
                Image: =ThisItem.img3
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Width: =196
                X: =569
                Y: =117
                ZIndex: =10

            Image6_8 As image:
                Height: =150
                Image: =ThisItem.img4
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Width: =196
                X: =808
                Y: =117
                ZIndex: =11

            Image6_9 As image:
                Height: =150
                Image: =ThisItem.img5
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Width: =196
                X: =1044
                Y: =117
                ZIndex: =12

        Titulo_16 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =56
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =1330
            X: =19
            Y: =118
            ZIndex: =3

            Label24_2 As label:
                FontWeight: =FontWeight.Bold
                Height: =56
                Text: |-
                    ="Activo_No:"
                Width: =102
                X: =119
                ZIndex: =1

            TextInput4_2 As text:
                BorderColor: =RGBA(0, 0, 0, 1)
                Default: =Dropdown2_2.SelectedText.Value
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(237, 237, 237, 1)
                RadiusBottomLeft: =30
                RadiusBottomRight: =30
                RadiusTopLeft: =30
                RadiusTopRight: =30
                Width: =186
                X: =232
                Y: =8
                ZIndex: =2

            Label24_3 As label:
                FontWeight: =FontWeight.Bold
                Height: =56
                Text: |-
                    ="Tipo de MTTO:"
                Width: =142
                X: =461
                ZIndex: =3

            TextInput4_3 As text:
                BorderColor: =RGBA(0, 0, 0, 1)
                Default: =Dropdown3_1.SelectedText.Value
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(237, 237, 237, 1)
                RadiusBottomLeft: =30
                RadiusBottomRight: =30
                RadiusTopLeft: =30
                RadiusTopRight: =30
                Width: =186
                X: =616
                Y: =8
                ZIndex: =4

            Icon13_2 As icon.Reload:
                Height: =48
                Icon: =Icon.Reload
                OnSelect: =Refresh(PreventivSure_PreguntasMP)
                Width: =61
                Y: =4
                ZIndex: =5

